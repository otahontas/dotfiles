#!/bin/sh
# Global pre-commit hook - runs enabled modules

HOOKS_LIB="$HOME/.config/git/hooks-lib"

# Hook flags (edit these in this file to enable/disable)
HOOK_GITLEAKS=1
HOOK_LLM_CHECK=0

echo ""
echo "=== Pre-commit hooks ==="

# Track if any hook failed
HOOK_FAILED=0

# Source and run enabled hooks
if [ "$HOOK_GITLEAKS" = "1" ]; then
    . "$HOOKS_LIB/gitleaks.sh"
    if ! run_gitleaks; then
        HOOK_FAILED=1
    fi
    echo ""
fi

if [ "$HOOK_LLM_CHECK" = "1" ]; then
    . "$HOOKS_LIB/llm-check.sh"
    if ! run_llm_check; then
        HOOK_FAILED=1
    fi
    echo ""
fi

echo "=== Pre-commit hooks complete ==="
echo ""

# Exit with failure if any hook failed
if [ $HOOK_FAILED -eq 1 ]; then
    echo "❌ Pre-commit hooks failed"
    exit 1
fi

echo "✅ All pre-commit hooks passed"
exit 0
